# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

language: java

jdk:
  - oraclejdk8

env:
  - TEST_SUITE=-Dnon-thirdparty=true
  - TEST_SUITE=-Dthirdparty=true

cache:
  directories:
    - $HOME/.ivy2
    - $HOME/jdbc

# No dependencies needed
install: true

before_script:
  - mkdir -p "$HOME/jdbc"
  - wget -nc -q --directory-prefix "$HOME/jdbc" $JDBC_CUBRID_URL $JDBC_DB2_URL $JDBC_MSSQL_URL $JDBC_MYSQL_URL $JDBC_ORACLE_URL $JDBC_POSTGRESQL_URL
  - ls "$HOME/jdbc"

script: ant -Dsqoop.thirdparty.lib.dir=$HOME/jdbc -Dsqoop.test.mysql.connectstring.host_url=jdbc:mysql://$SQOOP_DB_HOST:3306/ -Dsqoop.test.mysql.databasename=sqoop -Dsqoop.test.mysql.password=$SQOOP_DB_PASSWORD -Dsqoop.test.mysql.username=sqoop -Dsqoop.test.oracle.connectstring=jdbc:oracle:thin:@//$SQOOP_DB_HOST:1521/sqoop -Dsqoop.test.oracle.username=SYSTEM -Dsqoop.test.oracle.password=$SQOOP_DB_PASSWORD -Dsqoop.test.postgresql.connectstring.host_url=jdbc:postgresql://$SQOOP_DB_HOST/ -Dsqoop.test.postgresql.database=sqoop -Dsqoop.test.postgresql.username=sqoop -Dsqoop.test.postgresql.password=$SQOOP_DB_PASSWORD -Dsqoop.test.cubrid.connectstring.host_url=jdbc:cubrid:$SQOOP_DB_HOST:33000 -Dsqoop.test.cubrid.connectstring.username=sqoop -Dsqoop.test.cubrid.connectstring.database=sqoop -Dsqoop.test.cubrid.connectstring.password=$SQOOP_DB_PASSWORD -Dmapred.child.java.opts="\-Djava.security.egd=file:/dev/../dev/urandom" -Dtest.timeout=10000000 -Dsqoop.test.sqlserver.connectstring.host_url=jdbc:sqlserver://$SQOOP_DB_HOST:1433 -Dsqoop.test.sqlserver.database=master -Dms.sqlserver.username=sa -Dms.sqlserver.password=$SQOOP_DB_PASSWORD -Dsqoop.test.db2.connectstring.host_url=jdbc:db2://$SQOOP_DB_HOST:50000 -Dsqoop.test.db2.connectstring.database=SQOOP -Dsqoop.test.db2.connectstring.username=DB2INST1 -Dsqoop.test.db2.connectstring.password=$SQOOP_DB_PASSWORD $TEST_SUITE test
